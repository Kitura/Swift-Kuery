<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SwiftKuery  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="SwiftKuery  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          SwiftKuery Docs
        </a>
         (99% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/Kitura/Swift-Kuery/">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">SwiftKuery Reference</a>
      <img class="carat" src="img/carat.png" />
      SwiftKuery  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AuxiliaryTable.html">AuxiliaryTable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Column.html">Column</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ConnectionPool.html">ConnectionPool</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ConnectionPoolConnection.html">ConnectionPoolConnection</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DummyColumBuilder.html">DummyColumBuilder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Migration.html">Migration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QueryBuilder.html">QueryBuilder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QueryBuilder/QuerySubstitutionNames.html">– QuerySubstitutionNames</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ResultSet.html">ResultSet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Table.html">Table</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Condition.html">Condition</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/IndexColumnOrdered.html">IndexColumnOrdered</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Join.html">Join</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/OrderBy.html">OrderBy</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Predicate.html">Predicate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/QueryError.html">QueryError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/QueryResult.html">QueryResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Union.html">Union</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Bool.html">Bool</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Date.html">Date</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Double.html">Double</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Float.html">Float</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Int.html">Int</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Int16.html">Int16</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Int32.html">Int32</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Int64.html">Int64</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UUID.html">UUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery2aaoiyAA6FilterVAD_ADtF">&amp;&amp;(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery2aaoiyAA6HavingVAD_ADtF">&amp;&amp;(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3allyAA9PredicateOyAA6FilterVAA22ScalarColumnExpressionVGAA6SelectVF">all(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3allyAA9PredicateOyAA6HavingVAA25AggregateColumnExpressionVGAA6SelectVF">all(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3anyyAA9PredicateOyAA6FilterVAA22ScalarColumnExpressionVGAA6SelectVF">any(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3anyyAA9PredicateOyAA6HavingVAA25AggregateColumnExpressionVGAA6SelectVF">any(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3ascyAA18IndexColumnOrderedOAA0E0CF">asc(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3avgyAA25AggregateColumnExpressionVAA5Field_pF">avg(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5countyAA25AggregateColumnExpressionVAA5Field_pF">count(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery13countDistinctyAA25AggregateColumnExpressionVAA5Field_pF">countDistinct(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4descyAA18IndexColumnOrderedOAA0E0CF">desc(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery6existsyAA6FilterVAA6SelectVF">exists(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery6existsyAA6HavingVAA6SelectVF">exists(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5firstyAA25AggregateColumnExpressionVAA5Field_pF">first(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4lastyAA25AggregateColumnExpressionVAA5Field_pF">last(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5lcaseyAA22ScalarColumnExpressionVAA0E0CF">lcase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5lcaseyAA22ScalarColumnExpressionVADF">lcase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5lcaseyAA25AggregateColumnExpressionVADF">lcase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3lenyAA22ScalarColumnExpressionVAA0E0CF">len(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3lenyAA22ScalarColumnExpressionVADF">len(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3lenyAA25AggregateColumnExpressionVADF">len(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3maxyAA25AggregateColumnExpressionVAA5Field_pF">max(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3mid_5start6lengthAA22ScalarColumnExpressionVAA0G0C_S2itF">mid(_:start:length:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3mid_5start6lengthAA22ScalarColumnExpressionVAF_S2itF">mid(_:start:length:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3mid_5start6lengthAA25AggregateColumnExpressionVAF_S2itF">mid(_:start:length:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3minyAA25AggregateColumnExpressionVAA5Field_pF">min(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery9notExistsyAA6FilterVAA6SelectVF">notExists(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery9notExistsyAA6HavingVAA6SelectVF">notExists(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3nowAA22ScalarColumnExpressionVyF">now()</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5round_2toAA22ScalarColumnExpressionVAA0F0C_SitF">round(_:to:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5round_2toAA22ScalarColumnExpressionVAE_SitF">round(_:to:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5round_2toAA25AggregateColumnExpressionVAE_SitF">round(_:to:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery3sumyAA25AggregateColumnExpressionVAA5Field_pF">sum(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5ucaseyAA22ScalarColumnExpressionVAA0E0CF">ucase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5ucaseyAA22ScalarColumnExpressionVADF">ucase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery5ucaseyAA25AggregateColumnExpressionVADF">ucase(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6DeleteVAA14AuxiliaryTableC_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6DeleteVSayAA14AuxiliaryTableCG_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6InsertVAA14AuxiliaryTableC_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6InsertVSayAA14AuxiliaryTableCG_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6SelectVAA14AuxiliaryTableC_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6SelectVSayAA14AuxiliaryTableCG_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6UpdateVAA14AuxiliaryTableC_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery4withyAA6UpdateVSayAA14AuxiliaryTableCG_ADtF">with(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery2oooiyAA6FilterVAD_ADtF">||(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:10SwiftKuery2oooiyAA6HavingVAD_ADtF">||(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Buildable.html">Buildable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ColumnCreator.html">ColumnCreator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ConditionalClause.html">ConditionalClause</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Connection.html">Connection</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Field.html">Field</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/IndexColumn.html">IndexColumn</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:10SwiftKuery17PreparedStatementP">PreparedStatement</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Query.html">Query</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:10SwiftKuery19QueryFilterProtocolP">QueryFilterProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:10SwiftKuery19QueryHavingProtocolP">QueryHavingProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:10SwiftKuery19QuerySuffixProtocolP">QuerySuffixProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ResultFetcher.html">ResultFetcher</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SQLDataType.html">SQLDataType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AggregateColumnExpression.html">AggregateColumnExpression</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AggregateColumnExpression/AggregateFunction.html">– AggregateFunction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Char.html">Char</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ConnectionPoolOptions.html">ConnectionPoolOptions</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Delete.html">Delete</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Filter.html">Filter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Having.html">Having</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Index.html">Index</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Insert.html">Insert</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Parameter.html">Parameter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Raw.html">Raw</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RawField.html">RawField</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SQLDate.html">SQLDate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ScalarColumnExpression.html">ScalarColumnExpression</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ScalarColumnExpression/ScalarFunction.html">– ScalarFunction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Select.html">Select</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Time.html">Time</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Timestamp.html">Timestamp</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Update.html">Update</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Varchar.html">Varchar</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <p align="center">
    <a href="http://kitura.io/">
        <img src="https://raw.githubusercontent.com/Kitura/Kitura/master/Sources/Kitura/resources/kitura-bird.svg?sanitize=true" height="100" alt="Kitura">
    </a>
</p>

<p align="center">
    <a href="https://kitura.github.io/Swift-Kuery/index.html">
    <img src="https://img.shields.io/badge/apidoc-SwiftKuery-1FBCE4.svg?style=flat" alt="APIDoc">
    </a>
    <a href="https://travis-ci.org/Kitura/Swift-Kuery">
    <img src="https://travis-ci.org/Kitura/Swift-Kuery.svg?branch=master" alt="Build Status - Master">
    </a>
    <img src="https://img.shields.io/badge/os-macOS-green.svg?style=flat" alt="macOS">
    <img src="https://img.shields.io/badge/os-linux-green.svg?style=flat" alt="Linux">
    <img src="https://img.shields.io/badge/license-Apache2-blue.svg?style=flat" alt="Apache 2">
    <a href="http://swift-at-ibm-slack.mybluemix.net/">
    <img src="http://swift-at-ibm-slack.mybluemix.net/badge.svg" alt="Slack Status">
    </a>
</p>
<h1 id='swift-kuery' class='heading'>Swift-Kuery</h1>

<p><code>Swift-Kuery</code> is a pluggable SQL database driver/SDK abstraction layer. Its main idea is to unify the APIs to the various relational databases, providing a Swifty yet SQL-like API. This allows easy switching between databases and forms the basis for an Object-Relational Mapping (ORM) framework.</p>

<p><a href="https://github.com/Kitura/Swift-Kuery-ORM">Swift-Kuery-ORM</a> is an ORM, built on top of Swift-Kuery, which allows you to simplify the persistence of model objects with your server.</p>

<p><code>Swift-Kuery</code> is an easy to learn, consumable framework that comes with a set of <a href="#list-of-plugins">implemented plugins</a>.</p>
<h2 id='table-of-contents' class='heading'>Table of Contents</h2>

<ul>
<li><a href="#swift-version">Swift version</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#sql-injection-prevention-using-parameterization">SQL Injection Prevention using Parameterization</a></li>
<li><a href="#prepared-statements">Prepared Statements</a></li>
<li><a href="#schema-management">Schema Management</a></li>
<li><a href="#query-examples">Query Examples</a></li>
<li><a href="#list-of-plugins">List of plugins</a></li>
<li><a href="#api-reference">API Reference</a></li>
<li><a href="#community">Community</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id='swift-version' class='heading'>Swift version</h2>

<p>The latest version of Swift-Kuery requires <strong>Swift 4.0</strong> or newer. You can download this version of the Swift binaries by following this <a href="https://swift.org/download/">link</a>. Compatibility with other Swift versions is not guaranteed.</p>
<h2 id='usage' class='heading'>Usage</h2>

<p>This example demonstrates how to execute an SQL query using <code>Swift-Kuery</code> with the <a href="https://github.com/Kitura/Swift-Kuery-PostgreSQL">Swift-Kuery-PostgreSQL</a> plugin.</p>

<p>The starting point for this example is an existing Swift package. If you don&rsquo;t have one already, create and enter a directory named e.g. <code>SwiftKueryExample</code>. Now run the swift package&rsquo;s init command, to create an executable type, by running <code>swift package init --type executable</code>.</p>
<h3 id='creating-a-postgresql-database' class='heading'>Creating A PostgreSQL Database</h3>

<ol>
<li><p>Install PostgreSQL</p>
<h4 id='mac' class='heading'>Mac</h4>

<p><code>brew install postgresql</code></p>
<h4 id='ubuntu-linux' class='heading'>Ubuntu Linux</h4>

<p><code>sudo apt-get install postgresql postgresql-contrib</code></p></li>
<li><p>Create a <code>school</code> database</p>
<pre class="highlight plaintext"><code>createdb school
psql school
</code></pre></li>
<li><p>Create a <code>grades</code> table</p>
<pre class="highlight plaintext"><code>CREATE TABLE "Grades" (
    id varchar(100) PRIMARY KEY,
    course text NOT NULL,
    grade integer
);  
</code></pre></li>
</ol>
<h3 id='update-your-package-swift-file' class='heading'>Update your Package.swift file</h3>

<p>Add Swift-Kuery and your Kuery plugin, in this case Swift-Kuery-PostgreSQL, to the dependencies within your application&rsquo;s <code>Package.swift</code> file. Substitute <code>&quot;x.x.x&quot;</code> with the latest <code>Swift-Kuery</code> <a href="https://github.com/Kitura/Swift-Kuery/releases">release</a> and <code>&quot;y.y.y&quot;</code> with the latest plugin <a href="https://github.com/Kitura/Swift-Kuery-PostgreSQL/releases">release</a>.</p>
<pre class="highlight swift"><code><span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="c1">// Add this line</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Kitura/Swift-Kuery.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"x.x.x"</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Kitura/Swift-Kuery-PostgreSQL.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"y.y.y"</span><span class="p">),</span>
  <span class="p">],</span>
  <span class="nv">targets</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">target</span><span class="p">(</span>
      <span class="nv">name</span><span class="p">:</span> <span class="o">...</span>
      <span class="c1">// Add the module to your target(s)</span>
      <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="s">"SwiftKuery"</span><span class="p">,</span> <span class="s">"SwiftKueryPostgreSQL"</span><span class="p">]),</span>
  <span class="p">]</span>
</code></pre>
<h3 id='executing-sql-queries' class='heading'>Executing SQL queries</h3>

<p>Inside the <code>main.swift</code> file:</p>

<ol>
<li><p>Add SwiftKuery and SwiftKueryPostgreSQL to your import statements:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftKuery</span>
<span class="kd">import</span> <span class="kt">SwiftKueryPostgreSQL</span>
</code></pre></li>
<li><p>Create a <code><a href="Classes/Table.html">Table</a></code> class, which matches the <code>grades</code> table you created in the database:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Grades</span><span class="p">:</span> <span class="kt">Table</span> <span class="p">{</span>
<span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"Grades"</span>
<span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="kt">Int32</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">primaryKey</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">course</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"course"</span><span class="p">,</span> <span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">grade</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"grade"</span><span class="p">,</span> <span class="kt">Int32</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">grades</span> <span class="o">=</span> <span class="kt">Grades</span><span class="p">()</span>
</code></pre></li>
<li><p>Create a pool of connections to PostgreSQL:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">pool</span> <span class="o">=</span> <span class="kt">PostgreSQLConnection</span><span class="o">.</span><span class="nf">createPool</span><span class="p">(</span><span class="nv">host</span><span class="p">:</span> <span class="s">"localhost"</span><span class="p">,</span> <span class="nv">port</span><span class="p">:</span> <span class="mi">5432</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">databaseName</span><span class="p">(</span><span class="s">"school"</span><span class="p">)],</span> <span class="nv">poolOptions</span><span class="p">:</span> <span class="kt">ConnectionPoolOptions</span><span class="p">(</span><span class="nv">initialCapacity</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">maxCapacity</span><span class="p">:</span> <span class="mi">50</span><span class="p">))</span>
</code></pre></li>
<li><p>Create some example students:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">students</span><span class="p">:</span> <span class="p">[[</span><span class="kt">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s">"computing"</span><span class="p">,</span> <span class="mi">92</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">"physics"</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">"history"</span><span class="p">,</span> <span class="mi">83</span><span class="p">]]</span>
</code></pre></li>
<li><p>Connect to database and perform an SQL query:</p>
<pre class="highlight swift"><code><span class="n">pool</span><span class="o">.</span><span class="nf">getConnection</span><span class="p">()</span> <span class="p">{</span> <span class="n">connection</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
<span class="k">guard</span> <span class="k">let</span> <span class="nv">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">print</span><span class="p">(</span><span class="s">"Unknown error"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nf">print</span><span class="p">(</span><span class="s">"Error when getting connection from pool: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">insertQuery</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">grades</span><span class="p">,</span> <span class="nv">rows</span><span class="p">:</span> <span class="n">students</span><span class="p">)</span>
<span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">insertQuery</span><span class="p">)</span> <span class="p">{</span> <span class="n">insertResult</span> <span class="k">in</span>
    <span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">grades</span><span class="p">))</span> <span class="p">{</span> <span class="n">selectResult</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">resultSet</span> <span class="o">=</span> <span class="n">selectResult</span><span class="o">.</span><span class="n">asResultSet</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">print</span><span class="p">(</span><span class="s">"No result set returned from query"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">resultSet</span><span class="o">.</span><span class="nf">forEach</span><span class="p">()</span> <span class="p">{</span> <span class="n">row</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">row</span> <span class="o">=</span> <span class="n">row</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// Processed all results</span>
                    <span class="k">return</span>
                <span class="p">}</span>
                <span class="c1">// Handle error</span>
                <span class="k">return</span>
            <span class="p">}</span>
            <span class="k">guard</span> <span class="n">row</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Expecting three elements per row</span>
                <span class="k">return</span> <span class="nf">print</span><span class="p">(</span><span class="s">"Row has wrong number of elements. Expecting 3, returned: </span><span class="se">\(</span><span class="n">row</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Student </span><span class="se">\(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">, studying </span><span class="se">\(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">, scored </span><span class="se">\(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></li>
<li><p>If you were to run the application at this point it would execute immediately because the SwiftKuery API behaves asynchronously. In the case of this simple executable you can add a Dispatch Semaphore to force the application to wait for the asynchronous callbacks to complete:</p>
<pre class="highlight swift"><code><span class="c1">// Add the following after the existing imports:</span>
<span class="kd">import</span> <span class="kt">Dispatch</span>
<span class="k">let</span> <span class="nv">waitSemaphore</span> <span class="o">=</span> <span class="kt">DispatchSemaphore</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></li>
</ol>

<p>// Update the forEach callback to look like:
resultSet.forEach() { row, error in
    guard let row = row else {
        // Processed all results
        waitSemaphore.signal()
        return
    }
    print(&ldquo;Student (row[0] ?? &rdquo;&ldquo;), studying (row[1] ?? &rdquo;&ldquo;), scored (row[2] ?? &rdquo;&ldquo;)&rdquo;)
}</p>

<p>// Add the following line at the end of the main.swift file
waitSemaphore.wait()</p>
<pre class="highlight plaintext"><code>
7. Save the `main.swift` file. Run `swift build` to build the executable.
8. Run the executable `.build/debug/&lt;yourPackageName&gt;.`

This will print the `id`, `course` and `grade` for each student, which are queried from the database:
</code></pre>

<p>Student 0, studying computing, scored 92
Student 1, studying physics, scored 75
Student 2, studying history, scored 83</p>
<pre class="highlight plaintext"><code>If you go to your database with `psql school` and enter `TABLE grades;` you can see that the table has been populated with the student data.

## SQL Injection Prevention using Parameterization

Unsanitized data that is used in dynamic queries is one of the most common causes of SQL injection vulnerabilities. Parameterizing queries can help to prevent SQL injection attacks.

The following code is vulnerable to SQL injection if `supplied_key1` or `supplied_key2` contain untrusted data (that is, data which has not been validated):
```swift
let query = Select(from: confidential)
  .where(confidential.key1 == supplied_key1 || confidential.key2 == supplied_key2)

connection.execute(query: query) { queryResult in
  ...
}
</code></pre>

<p>To guard against SQL Injection attacks, use the following parameterized version of the code:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">confidential</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">confidential</span><span class="o">.</span><span class="n">key1</span> <span class="o">==</span> <span class="kt">Parameter</span><span class="p">()</span> <span class="o">||</span> <span class="n">confidential</span><span class="o">.</span><span class="n">key2</span> <span class="o">==</span> <span class="kt">Parameter</span><span class="p">())</span>

<span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="n">supplied_key1</span><span class="p">,</span> <span class="n">supplied_key2</span><span class="p">)</span> <span class="p">{</span> <span class="n">queryResult</span> <span class="k">in</span>
  <span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h2 id='prepared-statements' class='heading'>Prepared Statements</h2>

<p>If your application executes the same (or similar) SQL statements repeatedly with different parameters you may improve the performance of the application by using a prepared statement. Prepared statements can reduce parsing time as the database parses and compiles the statement template only once and then stores the result but doesn’t execute it. Later, the application supplies values for the parameters of the statement template and the database executes the statement.</p>

<p>For example, suppose our application needs to retrieve the average grade for courses with an average above a given value; a value which we want to vary. Let’s change our query to use a parameter instead of a predefined value:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">course</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="nf">avg</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">grade</span><span class="p">),</span> <span class="nv">to</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="nf">as</span><span class="p">(</span><span class="s">"average"</span><span class="p">),</span> <span class="nv">from</span><span class="p">:</span> <span class="n">grades</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">group</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">grades</span><span class="o">.</span><span class="n">course</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">having</span><span class="p">(</span><span class="nf">avg</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">grade</span><span class="p">)</span> <span class="o">&gt;</span> <span class="kt">Parameter</span><span class="p">())</span>
            <span class="o">.</span><span class="nf">order</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="kt">ASC</span><span class="p">(</span><span class="nf">avg</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">grade</span><span class="p">)))</span>
</code></pre>

<p>Now, prepare the statement and execute as many times as required with different parameter values. Use the <code>release</code> function to free the prepared statement:</p>
<pre class="highlight swift"><code><span class="n">connection</span><span class="o">.</span><span class="nf">prepareStatement</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">statement</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">asPreparedStatement</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Handle error</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="c1">// Execute the statement</span>
    <span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">preparedStatement</span><span class="p">:</span> <span class="n">preparedStatement</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="p">[</span><span class="mi">70</span><span class="p">])</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
        <span class="o">...</span>
        <span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">preparedStatement</span><span class="p">:</span> <span class="n">preparedStatement</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">])</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
            <span class="o">...</span>
            <span class="n">connection</span><span class="o">.</span><span class="nf">release</span><span class="p">(</span><span class="nv">preparedStatement</span><span class="p">:</span> <span class="n">preparedStatement</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
                <span class="o">...</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><strong>Note</strong>: <code>preparedStatement</code> is a plugin-specific handle for the prepared statement.</p>
<h2 id='schema-management' class='heading'>Schema Management</h2>
<h3 id='table-creation' class='heading'>Table creation</h3>

<p>Swift-Kuery enables you to create tables on the database server.</p>

<p>Let&rsquo;s revisit the Grades table, which we used in our Example above:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Grades</span><span class="p">:</span> <span class="kt">Table</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"Grades"</span>
    <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="kt">Int32</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">primaryKey</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">course</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"course"</span><span class="p">,</span> <span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">grade</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"grade"</span><span class="p">,</span> <span class="kt">Int32</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>We will add a second table called <code>courses</code>:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Courses</span><span class="p">:</span> <span class="kt">Table</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"Courses"</span>
    <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"name"</span><span class="p">,</span> <span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">primaryKey</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">credit</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"credit"</span><span class="p">,</span> <span class="kt">Int32</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">teacher</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"teacher"</span><span class="p">,</span> <span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">courses</span> <span class="o">=</span> <span class="kt">Courses</span><span class="p">()</span>
</code></pre>

<p>We can add a foreign key to <code>Grades</code> that references a column in another table:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">grades</span> <span class="o">=</span> <span class="kt">Grades</span><span class="p">()</span><span class="o">.</span><span class="nf">foreignKey</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">course</span><span class="p">,</span> <span class="nv">references</span><span class="p">:</span> <span class="n">courses</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre>

<p>Create a multi-column primary key (if not set in the column as for <code>Grades.id</code>)</p>
<pre class="highlight swift"><code><span class="n">grades</span><span class="o">.</span><span class="nf">primaryKey</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">grades</span><span class="o">.</span><span class="n">course</span><span class="p">)</span>
</code></pre>

<p>Create the table in the database:</p>
<pre class="highlight swift"><code>
<span class="n">courses</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="nv">connection</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
     <span class="k">guard</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Failed to create table: </span><span class="se">\(</span><span class="n">result</span><span class="o">.</span><span class="n">asError</span><span class="p">?</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
     <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h3 id='indices' class='heading'>Indices</h3>

<p>You can manage indices with Swift-Kuery in the following way:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">index</span> <span class="o">=</span> <span class="kt">Index</span><span class="p">(</span><span class="s">"index"</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">grades</span><span class="p">,</span> <span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="n">grades</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">grade</span><span class="p">)])</span>
<span class="n">index</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="nv">connection</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span> <span class="o">...</span> <span class="p">}</span>
<span class="o">...</span>
<span class="n">index</span><span class="o">.</span><span class="nf">drop</span><span class="p">(</span><span class="nv">connection</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>
<h3 id='migration' class='heading'>Migration</h3>

<p>Swift-Kuery has a class <code><a href="Classes/Migration.html">Migration</a></code> to help with migrations between two versions of a table.</p>

<p>Suppose we have a table <code>MyTable</code> in our application. The suggested usage is to keep versions of the table classes somewhere in the application code:</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">class</span> <span class="kt">MyTable_v0</span><span class="p">:</span> <span class="kt">Table</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">a</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">b</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"b"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"MyTable"</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="kt">MyTable_v1</span><span class="p">:</span> <span class="kt">Table</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">b</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"b"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">c</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"c"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"MyTable"</span>
<span class="p">}</span>
</code></pre>

<p>Use a typealias to refer to the current version of the table class in the application:</p>
<pre class="highlight swift"><code><span class="kd">typealias</span> <span class="kt">MyTable</span> <span class="o">=</span> <span class="kt">MyTable_v0</span>
<span class="k">let</span> <span class="nv">t</span> <span class="o">=</span> <span class="kt">MyTable</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">q</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="n">from</span> <span class="n">t</span><span class="p">)</span>
<span class="o">...</span>
</code></pre>

<p>The migration code from v0 to v1 should be something like this:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">t0</span> <span class="o">=</span> <span class="kt">MyTable_v0</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">t1</span> <span class="o">=</span> <span class="kt">MyTable_v1</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">migration0</span> <span class="o">=</span> <span class="kt">Migration</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t0</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">using</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span>
<span class="n">migration0</span><span class="o">.</span><span class="nf">alterTableAdd</span><span class="p">(</span><span class="nv">column</span><span class="p">:</span> <span class="n">t1</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>

<p>You can also execute raw alterations, if needed:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">dropColumnQuery</span> <span class="o">=</span> <span class="s">"ALTER TABLE "</span> <span class="o">+</span> <span class="n">t1</span><span class="o">.</span><span class="n">tableName</span> <span class="o">+</span> <span class="s">" DROP COLUMN "</span> <span class="o">+</span> <span class="n">t0</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">name</span>
<span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">dropColumnQuery</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>
<h2 id='query-examples' class='heading'>Query Examples</h2>

<p>In the following section, we will provide an example SQL query and show you how to build and execute the same query in Swift using Swift-Kuery.</p>
<h4 id='classes-used-in-the-examples' class='heading'>Classes used in the examples:</h4>

<p>These examples we will use the following two tables:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">T1</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"t1"</span>
  <span class="k">let</span> <span class="nv">a</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span>
  <span class="k">let</span> <span class="nv">b</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"b"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">T2</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">tableName</span> <span class="o">=</span> <span class="s">"t2"</span>
  <span class="k">let</span> <span class="nv">c</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"c"</span><span class="p">)</span>
  <span class="k">let</span> <span class="nv">b</span> <span class="o">=</span> <span class="kt">Column</span><span class="p">(</span><span class="s">"b"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT * FROM t1;</strong></p>

<p>This query will select all results from the table. The example below shows how to execute this query including the boilerplate code:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">t1</span> <span class="o">=</span> <span class="kt">T1</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>

<span class="n">pool</span><span class="o">.</span><span class="nf">getConnection</span><span class="p">()</span> <span class="p">{</span> <span class="n">connection</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Handle error</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span> <span class="p">{</span> <span class="n">queryResult</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">resultSet</span> <span class="o">=</span> <span class="n">queryResult</span><span class="o">.</span><span class="n">asResultSet</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Handle error</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="n">resultSet</span><span class="o">.</span><span class="nf">getColumnTitles</span><span class="p">()</span> <span class="p">{</span> <span class="n">titles</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">titles</span> <span class="o">=</span> <span class="n">titles</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Handle error</span>
                <span class="k">return</span>
            <span class="p">}</span>
            <span class="c1">//Process titles</span>
            <span class="n">resultSet</span><span class="o">.</span><span class="nf">forEach</span><span class="p">()</span> <span class="p">{</span> <span class="n">row</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">row</span> <span class="o">=</span> <span class="n">row</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// Processed all results</span>
                    <span class="k">return</span>
                <span class="p">}</span>
                <span class="c1">// Process row</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


</code></pre>

<p>The following examples show more complex queries, which can be substituted into the the above boilerplate.
&nbsp;</p>

<p><strong>SELECT a, b FROM t1<br>
   WHERE (a LIKE &lsquo;%b&rsquo; OR a = &lsquo;apple&rsquo;) AND b &gt; 5<br>
   ORDER BY b ASC, a DESC<br>
   OFFSET 5;</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">((</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="nf">like</span><span class="p">(</span><span class="s">"b%"</span><span class="p">)</span> <span class="o">||</span> <span class="n">t1</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="s">"apple"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">t1</span><span class="o">.</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">order</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="kt">ASC</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> <span class="o">.</span><span class="kt">DESC</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
  <span class="o">.</span><span class="nf">offset</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT UCASE(a) AS name FROM t1<br>
 WHERE b &gt;= 0<br>
 GROUP BY a<br>
 HAVING SUM(b) &gt; 3<br>
 ORDER BY a DESC;</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nf">ucase</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="nf">as</span><span class="p">(</span><span class="s">"name"</span><span class="p">),</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">group</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">having</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">order</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="kt">DESC</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>INSERT INTO t1<br>
VALUES (&lsquo;apple&rsquo;, 10), (&lsquo;apricot&rsquo;, 3), (&lsquo;banana&rsquo;, 17);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">rows</span><span class="p">:</span> <span class="p">[[</span><span class="s">"apple"</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="s">"apricot"</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s">"banana"</span><span class="p">,</span> <span class="mi">17</span><span class="p">]])</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>INSERT INTO t1<br>
VALUES (&lsquo;apple&rsquo;, 10);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">values</span><span class="p">:</span> <span class="s">"apple"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>INSERT INTO t1 (a, b)<br>
VALUES (&lsquo;apricot&rsquo;, &lsquo;3&rsquo;);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">valueTuples</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s">"apricot"</span><span class="p">),</span> <span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="s">"3"</span><span class="p">))</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>INSERT INTO t1 (a, b)<br>
VALUES (&lsquo;apricot&rsquo;, &lsquo;3&rsquo;);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">],</span> <span class="nv">values</span><span class="p">:</span> <span class="p">[</span><span class="s">"apricot"</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>UPDATE t1 SET a = &lsquo;peach&rsquo;, b = 2<br>
WHERE a = &lsquo;banana&rsquo;;</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Update</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="nv">set</span><span class="p">:</span> <span class="p">[(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s">"peach"</span><span class="p">),</span> <span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="s">"banana"</span><span class="p">)</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT * FROM t1 AS left<br>
LEFT JOIN t2 AS right<br>
ON left.b = right.b;</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">t1</span> <span class="o">=</span> <span class="kt">T1</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">t2</span> <span class="o">=</span> <span class="kt">T2</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">leftTable</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="nf">as</span><span class="p">(</span><span class="s">"left"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">rightTable</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="nf">as</span><span class="p">(</span><span class="s">"right"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">leftTable</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">leftJoin</span><span class="p">(</span><span class="n">rightTable</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">on</span><span class="p">(</span><span class="n">leftTable</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="n">rightTable</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT * FROM t1<br>
JOIN t2<br>
USING (b);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">join</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">using</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</code></pre>

<p>&nbsp;</p>
<h4 id='queries-with-parameters' class='heading'>Queries with parameters:</h4>

<p><strong>Note</strong>: Named parameters are supported for all databases, even for those that do not support named parameters (e.g. PostgreSQL).</p>

<p><strong>INSERT INTO t1<br>
VALUES (@0,@1);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">values</span><span class="p">:</span> <span class="kt">Parameter</span><span class="p">(),</span> <span class="kt">Parameter</span><span class="p">())</span>

<span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="s">"banana"</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span> <span class="p">{</span> <span class="n">queryResult</span> <span class="k">in</span>
  <span class="c1">// Process result</span>
<span class="p">}</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>INSERT INTO t1<br>
VALUES (@fruit,@number);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Insert</span><span class="p">(</span><span class="nv">into</span><span class="p">:</span> <span class="n">t1</span><span class="p">,</span> <span class="nv">values</span><span class="p">:</span> <span class="kt">Parameter</span><span class="p">(</span><span class="s">"fruit"</span><span class="p">),</span> <span class="kt">Parameter</span><span class="p">(</span><span class="s">"number"</span><span class="p">))</span>

<span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="p">[</span><span class="s">"number"</span> <span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s">"fruit"</span> <span class="p">:</span> <span class="s">"banana"</span><span class="p">])</span> <span class="p">{</span> <span class="n">queryResult</span> <span class="k">in</span>
  <span class="c1">// Process result</span>
<span class="p">}</span>
</code></pre>

<p>&nbsp;</p>

<p>It is possible to insert NULL values using parameters:
&nbsp;</p>
<pre class="highlight swift"><code><span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">:</span> <span class="p">[</span><span class="s">"number"</span> <span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s">"fruit"</span> <span class="p">:</span> <span class="kc">nil</span><span class="p">])</span> <span class="p">{</span> <span class="n">queryResult</span> <span class="k">in</span>
  <span class="c1">// Process result</span>
<span class="p">}</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>Raw query:</strong></p>
<pre class="highlight swift"><code><span class="n">connection</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="s">"CREATE TABLE myTable (a varchar(40), b integer)"</span><span class="p">)</span> <span class="p">{</span>  <span class="n">queryResult</span> <span class="k">in</span>
  <span class="c1">// Process result</span>
<span class="p">}</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT LEFT(a, 2) as raw FROM t1<br>
 WHERE b &gt;= 0
 GROUP BY a<br>
 HAVING sum(b) &gt; 3<br>
 ORDER BY a DESC;</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="kt">RawField</span><span class="p">(</span><span class="s">"LEFT(a, 2) as raw"</span><span class="p">),</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="s">"b &gt;= 0"</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">group</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">having</span><span class="p">(</span><span class="s">"sum(b) &gt; 3"</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">order</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="kt">DESC</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT * FROM t1<br>
WHERE b &gt;= ANY (SELECT b FROM t2);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span> <span class="o">&gt;=</span> <span class="nf">any</span><span class="p">(</span><span class="kt">Select</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t2</span><span class="p">)))</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT * FROM t1<br>
WHERE NOT EXISTS (SELECT * FROM t2 WHERE b &lt; 8);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="nf">notExists</span><span class="p">(</span><span class="kt">Select</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">b</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)))</span>
</code></pre>

<p>&nbsp;</p>

<p><strong>SELECT c FROM t2
GROUP BY c<br>
HAVING SUM(b) NOT IN (SELECT b FROM t1 WHERE a = &lsquo;apple&rsquo;);</strong></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Select</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t2</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">group</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">t2</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">having</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="nf">notIn</span><span class="p">(</span><span class="kt">Select</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="s">"apple"</span><span class="p">)))</span>
</code></pre>
<h2 id='list-of-plugins' class='heading'>List of plugins</h2>

<ul>
<li><p><a href="https://github.com/Kitura/Swift-Kuery-PostgreSQL">PostgreSQL</a></p></li>
<li><p><a href="https://github.com/Kitura/Swift-Kuery-SQLite">SQLite</a></p></li>
<li><p><a href="https://github.com/Kitura/SwiftKueryMySQL">MySQL</a></p></li>
</ul>
<h2 id='api-documentation' class='heading'>API Documentation</h2>

<p>For more information visit our <a href="https://kitura.github.io/Swift-Kuery/index.html">API reference</a>.</p>
<h2 id='community' class='heading'>Community</h2>

<p>We love to talk server-side Swift, and Kitura. Join our <a href="http://swift-at-ibm-slack.mybluemix.net/">Slack</a> to meet the team!</p>
<h2 id='license' class='heading'>License</h2>

<p>This library is licensed under Apache 2.0. Full license text is available in <a href="https://github.com/Kitura/Swift-Kuery/blob/master/LICENSE.txt">LICENSE</a>.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2021 <a class="link" href="" target="_blank" rel="external">IBM &amp; Kitura project authors</a>. All rights reserved. (Last updated: 2021-01-25)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
